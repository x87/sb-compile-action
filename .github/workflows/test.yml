name: Test SannyBuilder Compile

on:
  workflow_dispatch:
    inputs:
      input-file:
        description: 'Path to the input script file'
        required: true
        default: 'script.txt'
      output-file:
        description: 'Path to the output file'
        required: false
        default: 'output.cs'
      edit-mode:
        description: 'Edit Mode'
        required: false
        default: 'sa_sbl'
        type: choice
        options:
          - sa_sbl
          - vc_sbl
          - gta3_sbl

jobs:
  compile:
    runs-on: windows-latest
    permissions:
      contents: read
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Compile with SannyBuilder
        uses: ./
        with:
          input-file: ${{ github.event.inputs.input-file || 'script.txt' }}
          output-file: ${{ github.event.inputs.output-file || 'output.cs' }}
          
      - name: Display Results
        if: always()
        shell: powershell
        run: |
          Write-Host "Compilation workflow completed"
          if (Test-Path "${{ github.event.inputs.output-file || 'output.cs' }}") {
            Write-Host "Output file created successfully"
          }
